---
tags:
  - mesh
  - Paper
---

# 基于调和映射的二次曲面分块网格高质量重建方法
在基于点云的逆向工程与CAD模型重建中，将离散点云分割并拟合为二次曲面（如平面、圆柱、圆锥、球体等）是生成轻量化、高精度B-rep结构模型的关键步骤。尽管先进的初始分块算法（如摘要所述，融合了二面角、主曲率、交叉场等多重特征与距离约束、二次曲面秩约束）能够高效、精确地将大规模点云划分为二次曲面区域，但其后续的网格重建仍面临严峻挑战。

经典Marching Cubes（MC）算法从点云符号距离场提取的初始网格边界存在严重的“阶梯状”凹凸不平（噪声），特别是在曲面间的交界处。直接将网格顶点映射到计算出的二次曲面上，对于分块内部的点效果显著，但对于**分界点**则失效。原因是MC算法生成的交界线无法保证与两个二次曲面的真实交线（解析曲线）一致，导致两个曲面片以**相互穿插、重叠的噪声形式**相交，而非光顺的、严密的结合（如图1所示）。这种几何上的不一致性使得简单的投影映射无法产生可用于CAD的高质量缝合边界。

为解决此问题，本报告阐述一种基于**调和映射（Harmonic Mapping）** 的核心技术，通过对初始脏网格进行预处理，使其满足投影条件，最终实现高质量网格乃至B-rep模型的重建。

## **核心方法：调和映射驱动的高质量重建流程**
整个流程的核心思想是：**将初始脏网格上的点，通过一个光滑的、保持边界的变形过程（即调和映射），使其整体“收缩”或“坍缩”到这样一个位置——即所有顶点都位于其所属二次曲面的符号距离场负值区域（内部）**。此后，一个简单的、沿法向或最短距离的投影映射即可将顶点精准地贴合到目标二次曲面上，从而获得光滑、平整的最终网格。
![[Pasted image 20250912120204.png]]
<center>点云输入</center>
![[screenshot_000015.png]]
<center>直接使用 marching cube 重建</center>
![[screenshot_000000 9.png]]
<center>初始分块</center>
![[screenshot_000010.png]]
<center>监测到需要做调和映射的边界点</center>

![[Pasted image 20250912120512.png]]
<center>直接进行调和映射，消除边缘自相交</center>
![[Pasted image 20250912122353.png]]
<center>重新拉回识别好的二次曲面上，实现网格和 B-rep 重建</center>
流程主要分为以下几个步骤：

**步骤一：初始处理与问题识别**

1. **输入**： 经先进分块算法处理后的点云数据，每个分块已关联一个拟合的最优二次曲面方程 $Q_i$。
    
2. **初始网格化**： 使用Marching Cubes算法为每个分块生成初始三角网格 $M^i_{initial}$。该网格逼近分块点云，但边界粗糙，且与其他分块的网格在交界处存在穿插和噪声。
    
3. **问题识别**： 直接对 $M^i_{initial}$ 的顶点 $v$ 执行向 $Q_i$ 的映射 $v' = project(v, Q_i)$。对于内部点，$v'$ 准确落在 $Q_i$ 上；对于边界点，由于 $v$ 可能位于 $Q_i$ 的正距离场（外部），直接投影可能将其拉向错误的方向，甚至加剧与相邻曲面片的穿插，导致裂缝或重叠。
    

**步骤二：调和映射预处理（关键步骤）**  
调和映射的目标是计算一个从初始网格到自身的新映射（变形），该映射在网格内部是光滑的（调和），并固定或满足边界条件。

1. **目标定义**： 对于每个分块网格 $M^i_{initial}$，我们希望得到一个变形后的网格 $M^i_{harmonic}$，其特点是：**所有顶点，尤其是当前位于高曲率边界区域的顶点，都移动到其目标二次曲面 $Q_i$ 的符号距离场负值区域（即“内部”）**。
    
2. **边界条件设置**：
    - **固定边界**： 将识别出的、与相邻分块**无关**的原始边界（如模型外轮廓）固定不变。
    - **自由坍缩边界**： 将**分块间交界**上的顶点标记为“高斯基高曲率边界点”。这些点**不**被固定到某个具体位置，而是作为**自由边界**参与调和映射计算。调和能量函数将驱动这些边界在光滑性的约束下**自然地向内收缩或坍缩**。
        
3. **调和能量最小化**：
    - 调和映射通过最小化**狄利克雷能量（Dirichlet Energy）** 来实现。其离散形式可表示为：  
        $$E = Σ_{edges} (w_{ij} * ||u_i - u_j||^2)$$
        其中 $u_i$ 是顶点 $i$ 的新坐标，$w_{ij}$ 是基于边长的权重（如余切权重）。
    - 求解过程即求解一个大型稀疏线性系统 $L U = 0$，其中 $L$ 是网格的拉普拉斯矩阵，$U$ 是顶点坐标向量。根据步骤2设置的边界条件（固定顶点坐标代入方程右侧），求解此系统即可得到内部顶点和自由边界顶点的新坐标 $U$。
    - **效果**： 该计算有效地将高曲率的、嘈杂的边界“熨平”并拉向分块内部，同时最大限度地保持了网格的总体形状和光滑性。经过几次迭代或一次求解后，网格 $M^i_{harmonic}$ 的所有顶点都将位于 $Q_i$ 的负距离场内。
**步骤三：最终投影与缝合**

    
5. **边界一致性保证**： 由于相邻分片在交界处都进行了**各自独立**的调和映射预处理（均向内坍缩），并使用**相同的原始解析二次曲面方程**进行计算，它们的投影后的边界将自然、精确地收敛到两个二次曲面的**真实解析交线**上。
    
6. **B-rep生成**： 获得光滑、平整且边界一致的分块网格 $M^i_{final}$ 后，即可提取其边界表示（B-rep）信息，包括面（Face）、边（Edge）、环（Loop）等拓扑元素，并辅以准确的二次曲面几何定义，从而生成完整的、CAD系统可用的B-rep模型。
    

## **总结与优势**

本方法的核心贡献在于引入了**调和映射**作为预处理工具，巧妙地解决了Marching Cubes网格在二次曲面分块边界处的固有缺陷